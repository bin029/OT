# 加班打卡应用 - 单元测试说明

## 📋 测试概述

本项目包含完整的单元测试套件，覆盖加班打卡应用的所有核心功能，包括：

- ✅ 工作日正常打卡场景
- ✅ 工作日异常场景（迟到、早退）
- ✅ 周末打卡场景
- ✅ 节假日调休日场景
- ✅ 手动补录场景
- ✅ 边界情况和错误处理

## 🚀 运行测试

### 方法1：浏览器运行（推荐）

1. 打开 `test.html` 文件
2. 点击"运行所有测试"按钮
3. 查看测试结果

### 方法2：命令行运行

```bash
# 安装依赖（如果需要）
npm install

# 运行测试
npm test

# 或者直接运行
node test-runner.js
```

### 方法3：本地服务器

```bash
# 启动本地服务器
npm start

# 然后在浏览器中访问
# http://localhost:8000/test.html
```

## 📊 测试场景详情

### 1. 工作日正常场景
- **准时上班准时下班** (9:00-18:30) → 加班0分钟
- **准时上班加班** (9:00-19:30) → 加班60分钟
- **准时上班加班2.5小时** (9:00-21:00) → 加班150分钟

### 2. 工作日迟到场景
- **迟到1小时准时下班** (10:00-18:30) → 加班-60分钟
- **迟到30分钟加班1小时** (9:30-19:30) → 加班30分钟
- **迟到2小时加班2小时** (11:00-20:30) → 加班0分钟

### 3. 工作日早退场景
- **准时上班早退1小时** (9:00-17:30) → 加班-60分钟
- **迟到1小时早退30分钟** (10:00-18:00) → 加班-90分钟
- **迟到3小时早退1.5小时** (12:00-17:00) → 加班-270分钟

### 4. 周末场景
- **周末工作8小时** (9:00-17:00) → 加班480分钟
- **周末全天工作** (8:00-20:00) → 加班720分钟

### 5. 节假日调休日场景
- **周末设置为调休日** → 按工作日规则计算
- **调休日迟到早退** → 考虑迟到和早退时间

### 6. 手动补录场景
- **只有手动补录** (补录2小时) → 加班120分钟
- **自动打卡+手动补录** (自动1小时+补录1小时) → 加班180分钟
- **周末补录** (周末8小时+补录4小时) → 加班720分钟

### 7. 边界情况
- **只有上班记录** → 加班0分钟
- **跨日期打卡** → 正确计算时长
- **补录0小时** → 加班0分钟

## 🔧 测试框架

项目使用自定义的轻量级测试框架，支持：

- `describe()` - 测试组
- `it()` - 单个测试用例
- `assert.equal()` - 值相等断言
- `assert.isTrue()` - 真值断言
- `assert.isFalse()` - 假值断言

## 📈 测试覆盖率

当前测试套件覆盖以下核心功能：

1. **加班时间计算逻辑** - `calculateOvertime()`
2. **日期类型判断** - `shouldCalculateAsWorkday()`
3. **时间差计算** - `calculateTimeDifference()`
4. **调休日设置** - 工作日覆盖逻辑

## 🎯 测试用例设计原则

1. **全面性** - 覆盖所有正常和异常场景
2. **边界测试** - 测试极限值和边界条件
3. **业务逻辑** - 基于实际业务规则编写
4. **可维护性** - 测试用例清晰易懂
5. **独立性** - 每个测试用例相互独立

## 📝 添加新测试

如需添加新的测试用例，请在 `js/timeRecorder.test.js` 文件中：

```javascript
test.describe('新功能测试', () => {
    test.it('具体测试场景描述', () => {
        // 测试逻辑
        const result = someFunction(input);
        test.assert.equal(result, expectedValue, '断言描述');
    });
});
```

## 🐛 常见问题

### Q: 测试运行失败
A: 检查浏览器控制台是否有错误信息，确保所有依赖文件正确加载。

### Q: 某些测试场景不符合预期
A: 检查测试数据和业务逻辑是否正确，可能需要调整 `calculateOvertime()` 方法。

### Q: 想要在不同日期运行测试
A: 修改测试文件中的日期字符串，确保测试日期对应正确的星期几。

## 🎉 贡献

欢迎提交新的测试用例或改进现有测试。如发现bug，请提交issue并附上失败的测试用例。